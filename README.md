# SynthRL: Cross-domain Synthesizer Sound Matching via Reinforcement Learning

This repository contains the source code developed for our IJCAI 2025 paper.

## Requirements

To set up the environment, install the required dependencies:
```
pip install -r requirements.txt
```

- **Dexed synthesizer**: The model training and dataset generation require the Dexed synthesizer. Please refer to the Dexed repository https://github.com/asb2m10/dexed and RenderMan repository https://github.com/fedden/RenderMan for installation instructions on a Linux system.
- **Surge synthesizer**: The out-of-domain dataset generation requires the Surge synthesizer. Please refer to the Surge repository https://github.com/surge-synthesizer/surge for installation instructions.

## Dataset
Due to size limitations, the dataset is not included in this repository. It can be generated by running:
```
python -m data.dexeddataset
```
```
python -m data.surgedataset
```

We will release pretrained checkpoints and pre-generated datasets with a simple download script. Download links will be added here soon. Until then, please generate the datasets locally using the commands above.

## Usage
### Train
SynthRL training process consists of three stages, as described in our paper:

1. **Stage 1**: Run `train.py` to train the model using only parameter loss.
```
python train.py
```
2. **Stage 2**: Run `finetune.py` with the `dexed` dataset.
```
python finetune.py --config-name stage2
```
3. **Stage 3**: Run `finetune.py` with the `surge` dataset.
```
python finetune.py --config-name stage3
```

### Evaluation
To evaluate the trained model, execute:
```
python evaluate.py
```

## Citation
If you use this work, please cite our paper:
```
@inproceedings{shin2025synthrl,
  title   = {{SynthRL}: Cross-domain Synthesizer Sound Matching via Reinforcement Learning},
  author  = {Shin, Wonchul and Lee, Kyogu},
  year    = {2025},
  booktitle   = {Proceedings of the 34th International Joint Conference on Artificial Intelligence}
}
```
We also acknowledge the upstream work (DAFx 2021):
```
@inproceedings{levaillant2021vaesynthprog,
	title        = {Improving Synthesizer Programming from Variational Autoencoders Latent Space},
	author       = {Le Vaillant, Gwendal and Dutoit, Thierry and Dekeyser, Sébastien},
	year         = 2021,
	month        = Sep,
	booktitle    = {Proceedings of the 24th International Conference on Digital Audio Effects (DAFx20in21)},
	location     = {Vienna, Austria}
}
```

## Attribution & License

This repository includes portions of code originally from Preset-Gen-VAE (https://github.com/gwendal-lv/preset-gen-vae).
Because it contains AGPL-3.0–licensed portions, this repository is distributed under **AGPL-3.0**.  
See `LICENSE` and `NOTICE`.
